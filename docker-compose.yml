services:
 nginx:
   image: nginx:alpine
   ports:
     - "8080:80"
     - "443:443"
   volumes:
     - ./nginx.conf:/etc/nginx/nginx.conf:ro
     - /etc/letsencrypt:/etc/letsencrypt:ro
   depends_on:
     - app

 app:
   build:
     context: .
   environment:
     - DB_NAME=postgres
     - DB_HOST=db
     - DB_PORT=5432
     - DB_USER=postgres
     - DB_PASS=postgres
     - JWT_SECRET=812659050808fd763749156b9b403c46a2338f082b4cc1316d3b0ac8794937aa
     - JWT_ACCESS_TOKEN_TIME=10000
     - JWT_ALGORITHM=HS256
   depends_on:
     - db

 db:
   image: postgres:15
   environment:
     POSTGRES_USER: postgres
     POSTGRES_PASSWORD: postgres
     POSTGRES_DB: postgres
   volumes:
     - postgres_data:/var/lib/postgresql/data

volumes:
 postgres_data: